import { NamedCodeBlock } from '~/components/atoms'

export const meta = {
  title: '新しいブログを公開しました。',
  tags: ['React', 'Next.js', 'MDX', 'TypeScript', 'Tailwind CSS'],
  publishDate: '2020-06-14',
  modifiedDate: false,
  seoDescription: 'Next.js / MDXでブログ構築しました。',
  exclude: false
}

かれこれ n 度目のブログを公開しました。
技術スタックは React, Next.js, MDX, TypeScript, Tailwind CSS 辺りを使っています。

Twitter の他にもアウトプットする場が欲しくて作りました。
Qiitaに時々記事を書いてたのでそっちに力を入れても良かったんですが、運営への不信感と全体的に記事の質が下がったと感じることが増えてきて検索にかかった時にしか開かなくなってしまいました。

ここでは日々詰まったことや学んだことをアウトプットしていくつもりです。

# 構成

Next.js で SSG (静的サイトジェネレータ) の機能を使って、記事を更新した際に静的ファイルを生成して Firebase Hosting で公開しています。
ブラウザアクセス後はSPAとして振る舞うので1度開けばページ遷移なしでページを切り替えれるようになります。

静的ファイルをホスティングする大きなメリットは  
・アクセス時にサーバーサイドで実行する処理が無いので無駄なリソースを消費しない  
・アクセス毎に変化がないので配信をCDNに乗せることでページ読み込み時間の短縮が期待できる  
などがあります。

同等の動きをするものだと React なら Gatsby、Vue なら VuePress もしくは Gridsome があって、実は前回ブログを公開してた時は Gatsby で作ったものを公開していました。
ただ Gatsby の設計が好きになれず GraphQL でアプリ内のコンテンツデータにアクセスする必要性がなく感じていて、今回は Next.js で構築しました。

記事データは当初 Markdown ファイルの予定だったのですが、Markdown + JSX の MDX というものを見つけたので採用しています。
これは Markdown 形式のなかで JavaScript や JSX が書けるもので記事のメタデータを JavaScript で管理しています。
JSXコンポーネントの読み込みも可能です。

<NamedCodeBlock filename="/contents/foo/index.mdx">

``` typescript
import { Foo } from '~/components'

export const meta = {
  title: '記事タイトル',
  tags: ['タグ1', 'タグ2', 'タグ2'],
  publishDate: '2020-06-14',
  modifiedDate: false,
  seoDescription: 'SEO/記事一覧用のサマリーテキスト',
  exclude: false
}

# 見出し1

<Foo />

マークダウン本文
マークダウン本文
マークダウン本文
```

</NamedCodeBlock>

こんなファイルを用意するとファイルパスと同じパス `http://ria0130.dev/article/foo` で公開されます。

# これから

この先いま構想してるものだと PWAでオフラインキャッシュ、AMP対応、Algoliaを使った記事検索 など付け足していきます。

まだ作ったばかりですが、もう少し落ち着いたらソースコードも公開していきます。


